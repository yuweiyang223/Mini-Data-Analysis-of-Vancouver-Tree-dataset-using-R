---
title: "Mini data analysis"
author: "Yuwei"
date: "2021/10/5"
output:
  github_document:
    html_preview: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message = FALSE)
```

Please install the following packages before running the code. 

```{r}
library(datateachr)
library(tidyverse)
library(ggplot2)
```

# Task 1: Choose datasets

## 1.1 Choose four datasets from datateachr packages:
  1: steam_games: Acquired courtesy of Kaggle. It currently has 40833 rows and 21 columns.
  
  2: flow_sample: Acquired courtesy of The Government of Canada’s Historical Hydrometric Database. It currently has 218 rows and 7 columns.
  
  3: parking_meters: Acquired courtesy of The City of Vancouver’s Open Data Portal. It currently has 10032 rows and 22 columns.
  
  4: cancer_sample: Acquired courtesy of UCI Machine Learning Repository. It currently has 569 rows and 32 columns.

## 1.2 Explore datasets: 

This part, I will check the class of the data using class(), the number of rows and column and the name of each columns with some useful information using glimse().

This is the information for steam_games data:
```{r}
class(steam_games)
glimpse(steam_games)
```

This is the information for flow_sample data:

```{r}
class(flow_sample)
glimpse(flow_sample)
```


This is the information for vancouver_trees data:
```{r}
class(vancouver_trees)
glimpse(vancouver_trees)
```


This is the information for cancer_sample data:

```{r}
class(cancer_sample)
glimpse(cancer_sample)
```

# 1.3 Select dataset:

The reasons for choosing these two datasets are quite different. I choose cancer_sample because the dataset contains a lot of variables and they are numeric values, so I think it will be interesting to analysis the relationship between these data and plot some useful graphs. And I choose steam_games because I have been using steam for few years so I am very interested in analyzing the data from steam games. 


steam_games: 1. Which developer and publisher receive the most achievements?
2. Does achievements of the game relate to the reviews(both recent and all reviews)?

flow_sample: 1. What the relationship of the flow rate respect with year? 2. What's the most busiest day every week?

Vancouver_trees: 1. For each species, will the height be very different? (use jitter plot/side by side boxplot) 2. Will the root barrier affect the diameter of the tree within each species? 
3. Does the plant area relate to the height of the tree? 4. For each neighborhood, how many trees were planted? 

Cancer_sample: For different diagnosis, will the parameters be different? 

I decide to choose vancouver_trees to analysis because the variable seem to have better relationship between them. 


#2.1
1. Plot the distribution of the number of trees using different height range id. (0-10 for every 10 feet (e.g., 0 = 0-10 ft, 1 = 10-20 ft, 2 = 20-30 ft, and 10 = 100+ ft))
```{r}
ggplot(vancouver_trees, aes(height_range_id)) +
  geom_histogram(binwidth=1, fill ="pink", alpha=0.8)+
  xlab("Tree Height Range ID")+ylab("Number of Trees")+
  theme_light()
```
2. Add a new variable named tree_age which is the number of years between the trees were planted and the current year 2021. I want to use this later to find the relationship between the age of the tree and the height of the tree. 


```{r}
age_and_height <- vancouver_trees %>%
  # Calling difftime() function
  mutate(tree_age = round(as.numeric(difftime("2021-10-01", date_planted, units="days"))/365,4)) %>%
  select(species_name,diameter, tree_age, root_barrier)

print(age_and_height)
```
3. Next, we are going to find out if there is a relationship between the age of the tree and the diameter of the tree and what is the relationship using geom_jitter. 

```{r}
ggplot(age_and_height, aes(tree_age, diameter))+
  geom_jitter(outlier.shape = NA, aes(alpha=0.6, colour=tree_age))+
  coord_cartesian(ylim =  c(0, 50))
```

4. As we can see, from the previous part, it seems that the age of the tree has a positive relationship with it's diameter. Next, we are going to analysis this in details by separating the trees into different species and look at the relationship within each species.
```{r}
age_and_height %>%
  group_by(species_name) %>%
  filter(n() >5000) %>%
  ggplot(aes(tree_age, diameter))+ 
  geom_point()+  facet_wrap(~species_name)+
  coord_cartesian(ylim =  c(0, 25))

```
5. Last thing I can think about is the root barrier might affect the trees' diameter. 

```{r}
age_and_height %>%
  filter(root_barrier == 'Y') %>%
  group_by(species_name)%>%
  filter(n()>500) %>%
  ggplot(aes(tree_age, diameter))+ 
  geom_point()+  facet_wrap(~species_name)+
  coord_cartesian(ylim =  c(0, 25))

```


# 3: The following four questions are the goal of this analysis:
1. For each species, will the height be very different? (use jitter plot/side by side boxplot) 2. Will the root barrier affect the diameter of the tree within each species? 
3. Will the age of the tree affect the height of the tree? 
4. How many trees are there at different height?
